# QA Report — SITESELECT GUI-first MVP

Date: 2026-02-14
Scope: GUI-first MVP（CLI能力层 + GUI流程可发布性）

## 执行摘要
- 已产出 QA 清单与测试用例（happy path + 边界场景）。
- CLI happy path 可用，报告可生成。
- 发现 1 个 P0 风险（缺失字段时 CLI 直接 traceback）。
- 发现 2 个 P1 风险（非法数值静默置0；权重无限制导致异常分数）。
- 当前环境缺少 `streamlit`，无法完成 GUI 运行态验证（环境 blocker）。

## 已执行命令与结果

### 1) 基础可执行性
```bash
python3 --version
python3 -m py_compile src/siteselect/cli.py app/gui_app.py
```
结果：通过（语法/编译通过）。

### 2) CLI Happy Path
```bash
python3 src/siteselect/cli.py analyze \
  --input examples/candidates.example.csv \
  --weights examples/weights.example.json \
  --top 5 \
  --out output/report.qa.html
```
结果：通过（exit 0），输出 `Top1: 候选点A (score=59.69)`，HTML 已生成。

### 3) Empty CSV
```bash
python3 src/siteselect/cli.py analyze \
  --input output/qa_empty.csv \
  --out output/qa_empty.html
```
结果：符合预期（exit 1），提示 `输入数据为空`。

### 4) Missing Field CSV
```bash
python3 src/siteselect/cli.py analyze \
  --input output/qa_missing_field.csv \
  --out output/qa_missing_field.html
```
结果：失败（exit 1），出现 `KeyError: 'distance_to_target_m'` traceback（非友好错误）。

### 5) Invalid Numerics
```bash
python3 src/siteselect/cli.py analyze \
  --input output/qa_invalid_numeric.csv \
  --out output/qa_invalid_numeric.html
```
结果：通过（exit 0），非法数值被静默按 `0.0` 处理。

### 6) Extreme Weights
```bash
python3 src/siteselect/cli.py analyze \
  --input examples/candidates.example.csv \
  --weights output/qa_extreme_weights.json \
  --out output/qa_extreme_weights.html
```
结果：通过（exit 0），分数放大至 `2422.88`。

```bash
python3 src/siteselect/cli.py analyze \
  --input examples/candidates.example.csv \
  --weights output/qa_negative_weights.json \
  --out output/qa_negative_weights.html
```
结果：通过（exit 0），允许负权重并输出结果（业务风险）。

### 7) GUI依赖检查
```bash
python3 -c "import streamlit"
```
结果：失败，`No module named 'streamlit'`。

## 缺陷与风险清单
1. **[P0] CLI缺失字段崩溃**
   - 现象：缺列时抛 KeyError traceback。
   - 影响：用户体验差，阻断分析流程。
   - 建议：在 `load_rows/cmd_analyze` 增加必填字段校验并输出友好错误。

2. **[P1] 非法数值静默降级为0**
   - 现象：`abc/N/A` 被当作 0.0。
   - 影响：结果可能失真且用户无感知。
   - 建议：增加数值校验与错误/告警（含行号与字段）。

3. **[P1] 权重缺少边界与归一化策略**
   - 现象：允许超大/负权重，分数可>100或非直觉。
   - 影响：可解释性与可信度下降。
   - 建议：限制 [0,1]，并校验总和（或自动归一化）。

## Blockers
- **环境 blocker**：当前机器未安装 streamlit，无法完成 GUI 运行态回归。

## 发布建议
- 作为 CLI 演示可继续，但**不建议按 GUI-first 标准发布**，需先关闭 P0 并补齐 GUI 运行验证。