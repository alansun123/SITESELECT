# PRD：餐饮细分行业智能选址工具（高德API版 / 本地部署）

## 1. 文档信息
- **产品名称**：SitePilot（暂定）
- **版本**：V1.0
- **部署方式**：本地笔记本（Local-first）
- **地图服务**：高德地图开放平台（Amap OpenAPI）
- **目标用户**：餐饮连锁企业选址人员（茶饮、冰激凌、甜点、烘焙、肉饼、高端面馆）
- **目标上线**：MVP 8~12 周

---

## 2. 背景与目标

### 2.1 背景
选址工作依赖经验，数据分散，跨业态复用困难，导致：
- 选址效率低
- 点位判断主观
- 复盘困难

### 2.2 产品目标
构建一套面向餐饮细分业态的“数据化选址”工具，实现：
1. 候选点位自动拉取、批量评估  
2. 分业态评分（同点位在不同业态下得分不同）  
3. 自动生成选址报告（推荐/谨慎/淘汰）  
4. 本地可运行，低门槛部署与迭代

### 2.3 关键KPI
- 评估周期缩短 50%
- 首店/新店达标率提升 15~20%
- 低质量点位误选率下降 30%

---

## 3. 用户与核心场景

### 3.1 角色
- 选址专员：批量筛点、初评
- 区域经理：审核、决策
- 拓展负责人：跨城布局、策略看板

### 3.2 核心场景
1. 输入“城市+商圈+业态” → 输出Top候选点位  
2. 对单个点位进行“茶饮 vs 冰激凌”可行性对比  
3. 一键生成门店立项报告用于审批  
4. 月度复盘：新店表现回灌模型参数

---

## 4. 范围定义（V1）

### 4.1 In Scope
- 地图工作台（点位检索、圈层、可达性）
- 高德API点位抓取与本地缓存
- 业态评分引擎（规则+权重）
- 候选点位管理（状态流转）
- 报告导出（PDF/分享链接）

### 4.2 Out of Scope
- 自动签约/租赁谈判
- 装修施工管理
- 外卖平台实时经营数据联动（V2）

---

## 5. 方案架构（本地运行）

- **前端**：React/Next.js
- **后端**：Python FastAPI（推荐）
- **数据库**：PostgreSQL + PostGIS（MVP可先SQLite）
- **地图与点位数据**：高德开放平台 API
- **部署**：本地 Docker Compose（或 Python venv）

---

## 6. 高德开放平台 API 设计（核心）

### 6.1 API使用清单
1. **POI搜索（关键词/周边）**
   - 获取竞品、商业体、交通、学校、办公等POI
2. **地理编码/逆地理编码**
   - 地址标准化、经纬度转换
3. **路径规划**
   - 步行/驾车时间与距离
4. **行政区查询**
   - 区域边界与层级过滤
5. **静态图（可选）**
   - 报告插图

### 6.2 API调用策略
- 在线拉取 + 本地缓存（TTL）
- 高频查询结果入库（避免重复调用）
- 限流与重试机制（指数退避）
- 错误降级：API失败时优先展示缓存数据

### 6.3 配置与安全
- 高德Key仅存本地 `.env`
- 不写入前端明文
- 调用日志脱敏
- 支持多Key轮询（企业配额）

---

## 7. 数据模型与评分逻辑

### 7.1 评分维度（0~100）
1. 客群匹配
2. 流量质量（时段+停留）
3. 可达性（步行/驾车时距）
4. 竞争压力（竞品数量/距离衰减）
5. 成本承压（租金/面积假设）
6. 场景适配（商场/社区/办公/学校）
7. 风险项（施工、封路、政策等）

### 7.2 总分公式
`总分 = Σ(维度得分 × 维度权重) - 风险惩罚分`

### 7.3 业态模板（示例）
- 茶饮：流量质量与竞争压力权重高  
- 冰激凌：场景与季节波动权重高  
- 甜点/烘焙：客群质量与场景匹配权重高  
- 肉饼：高频刚需与可达性权重高  
- 高端面馆：客群消费能力与成本承压权重高

---

## 8. 功能需求

### 8.1 地图工作台
- 输入城市/商圈/关键词
- 地图选点、画圈（500m/1km/3km）
- 显示竞品、交通、商业体图层开关
- 支持步行/驾车等时圈分析

### 8.2 候选点位管理
- 点位导入（Excel/API）
- 状态：待评估/实勘中/通过/淘汰
- 备注、附件、责任人、时间线

### 8.3 批量评估
- 批量计算得分
- 按业态、区域、分值排序
- 筛选“推荐候选池”

### 8.4 点位详情页
- 综合评分 + 雷达图
- 竞品列表（距离、类型、密度）
- 可达性结果（5/10/15分钟）
- 风险提示与建议动作

### 8.5 报告系统
- 一键导出PDF
- 内容：结论、数据证据、竞品格局、风险与建议
- 审批版/简版两种模板

---

## 9. 关键流程

1. 选择城市与目标业态  
2. 拉取候选点位（高德API + 本地点位）  
3. 自动评分与排序  
4. 人工复核Top N并发起实勘  
5. 回填实勘结果后复评  
6. 生成报告并决策  
7. 开店后复盘（V1可手工回填）

---

## 10. 非功能需求
- 单点评估响应 < 3秒
- 1000点批量评估 < 10分钟
- 本地断网时可用缓存数据查看历史结果
- 角色权限（专员/经理/管理员）
- 所有评分结果可追溯（版本+参数）

---

## 11. 验收标准（MVP）
- 成功接入高德核心API（POI/地理编码/路径规划）
- 支持6类业态评分模板
- 支持单点与批量评估
- 选址报告可导出并用于审批
- 至少1个城市完成真实选址试运行（>20个点位）

---

## 12. 里程碑

- **第1-2周**：数据与地图底座（高德API接入、本地缓存）
- **第3-4周**：评分引擎与业态模板
- **第5-6周**：批量评估与点位管理
- **第7-8周**：报告系统与试运行
- **第9-12周（可选）**：优化与首城上线

---

## 13. 风险与对策
1. **API配额不足** → 缓存+批处理+多Key策略  
2. **POI分类偏差** → 建立内部“餐饮业态标签映射表”  
3. **模型偏差** → 周期性权重校准+人工复核机制  
4. **本地性能不足** → 批量异步任务+结果预计算
